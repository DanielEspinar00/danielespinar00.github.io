<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <title>Ruta 151</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <!-- Favicon -->
    <link rel="icon" href="./images/logo-tienda.PNG" type="image/PNG" />

</head>
<body>
    
    <div class="header">
        <img src="./images/logo-tienda.PNG" alt="Ruta 151 Logo">
    </div>

    <div id="icon-list1" class="icon-list"></div>
    
    <h2 id="h-lista-productos">Lista de Productos</h2>
    <div class="product-container" id="product-list"></div>
    
    <!-- Panel de contacto -->
    <div class="contact-panel">
        <h3>Reservas e informaci√≥n</h3>
        <div id="icon-list2" class="icon-list"></div>
    </div>

    <script>
        async function getFileVersion(filePath) {
            try {
                const response = await fetch(filePath, { method: 'HEAD' });
                const lastModified = response.headers.get('Last-Modified');
                return lastModified ? new Date(lastModified).getTime() : new Date().getTime();
            } catch (error) {
                console.error(`Error obteniendo la versi√≥n de ${filePath}:`, error);
                return new Date().getTime();
            }
        }

        async function loadFiles() {
            const styleVersion = await getFileVersion('./style.css');
            const scriptVersion = await getFileVersion('./script.js');

            // Cargar CSS
            const link = document.createElement('link');
            link.rel = 'stylesheet';
            link.href = `./style.css?v=${styleVersion}`;
            document.head.appendChild(link);

            // Cargar JS con defer para asegurarse de que se ejecuta despu√©s de parsear el DOM
            const script = document.createElement('script');
            script.src = `./script.js?v=${scriptVersion}`;
            script.defer = true; // üëà Esto hace que espere a que el DOM est√© listo
            document.body.appendChild(script);
        }

        async function loadImages() {
            const images = document.querySelectorAll('img');
            for (let img of images) {
                const imgSrc = img.getAttribute('src');
                if (imgSrc && imgSrc.startsWith('images/')) {
                    const imgVersion = await getFileVersion(imgSrc);
                    img.src = `${imgSrc}?v=${imgVersion}`;
                }
            }
        }

        loadImages();
        loadFiles();
    </script>
</body>
</html>
